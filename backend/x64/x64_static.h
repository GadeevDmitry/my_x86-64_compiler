#ifndef X64_STATIC_H
#define X64_STATIC_H

#include <stdio.h>
#include <stdlib.h>
#include <stdarg.h>

#define LOG_NTRACE
#include "../../lib/logs/log.h"
#include "../../lib/algorithm/algorithm.h"

#include "x64.h"

//================================================================================================================================
// GLOBAL
//================================================================================================================================

const char *X64_CMD_names[] =
{
    "ADD"   ,
    "SUB"   ,
    "IMUL"  ,
    "IDIV"  ,

    "OR"    ,
    "AND"   ,
    "XOR"   ,

    "CMP"   ,
    "TEST"  ,

    "SETcc" ,
    "Jcc"   ,

    "CALL"  ,
    "JMP"   ,
    "RET"   ,

    "PUSH"  ,
    "POP"   ,
};

//--------------------------------------------------------------------------------------------------------------------------------

const char *X64_cc_names[] =
{
    "G (greater)"           ,
    "L (less)"              ,
    "E (equal)"             ,

    "GE (greater or equal)" ,
    "LE (less or equal)"    ,
    "NE (not equal)"        ,
};

//--------------------------------------------------------------------------------------------------------------------------------

const char *GPR_names[] =
{
    "RAX"   ,
    "RCX"   ,
    "RDX"   ,
    "RBX"   ,
    "RSP"   ,
    "RBP"   ,
    "RSI"   ,
    "RDI"   ,

    "R8"    ,
    "R9"    ,
    "R10"   ,
    "R11"   ,
    "R12"   ,
    "R13"   ,
    "R14"   ,
    "R15"   ,
};

//================================================================================================================================
// X64_operand
//================================================================================================================================

//--------------------------------------------------------------------------------------------------------------------------------
// ctor
//--------------------------------------------------------------------------------------------------------------------------------

bool x64_operand_ctor(x64_operand *const operand, const bool is_reg,
                                                  const bool is_mem,
                                                  const bool is_imm, ...);

//--------------------------------------------------------------------------------------------------------------------------------
// dump
//--------------------------------------------------------------------------------------------------------------------------------

static void x64_operand_header_dump(const x64_operand *const operand) __attribute__((always_inline));
static void x64_operand_fields_dump(const x64_operand *const operand);
static void x64_operand_ending_dump()                                 __attribute__((always_inline));

//================================================================================================================================
// X64_node
//================================================================================================================================

//--------------------------------------------------------------------------------------------------------------------------------
// dump
//--------------------------------------------------------------------------------------------------------------------------------

static void x64_node_header_dump(const x64_node *const node) __attribute__((always_inline));
static void x64_node_fields_dump(const x64_node *const node);
static void x64_node_ending_dump()                           __attribute__((always_inline));

#endif //X64_STATIC_H
